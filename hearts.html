<!DOCTYPE html>
<html>
  <head>
    <title>SVG Fargevelger</title>
    <style>
      body {
        margin: 0;
        background-color: lightblue;
      }
      .container {
        width: 800px;
        margin: auto;
        background-color: white;
        display: flex;
        justify-content: center;
      }
      .left {
        width: 600px;
        padding: 20px;
        display: flex;
        flex-direction: column;
        align-items: center;
      }
      .right {
        width: 200px;
        padding: 20px;
        display: flex;
        flex-direction: column-reverse;
        align-items: flex-start;
      }
      button {
        font-size: larger;
        margin-top: 20px;
      }
      #heartList {
        display: flex;
        flex-direction: column;
      }
      .preview-number {
        font-weight: bold;
        padding-bottom: 5px;
      }
      .error-message {
        color: red;
        font-size: smaller;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="left">
        <svg id="mySvg" width="200" height="200" fill="#808080">
          <circle class="myCircle" cx="50" cy="50" r="30" fill="blue" />
          <rect class="myRect" x="100" y="100" width="50" height="50" fill="green" />
        </svg>
        <button id="save">Lagre</button>
        <div class="error-message" id="errorMessage" style="display: none">Denne kombinasjonen finnes allerede.</div>
        <input type="color" id="colorPicker" value="#808080" style="display: none" />
      </div>
      <div class="right">
        <div id="heartList"></div>
      </div>
    </div>

    <script>
      document.addEventListener('DOMContentLoaded', function () {
        const errorMessage = document.getElementById('errorMessage');
        const originalSvg = document.getElementById('mySvg');
        const circle = originalSvg.querySelector('.myCircle');
        const rect = originalSvg.querySelector('.myRect');
        const colorPicker = document.getElementById('colorPicker');
        const saveButton = document.getElementById('save');
        const heartList = document.getElementById('heartList');

        let selectedElement = null;

        function loadHearts() {
          const savedHearts = JSON.parse(localStorage.getItem('hearts')) || [];
          savedHearts.reverse();
          heartList.innerHTML = '';
          savedHearts.forEach((heart, index) => {
            const number = savedHearts.length - index;
            const heartDiv = document.createElement('div');
            const cloneSvg = originalSvg.cloneNode(true);
            cloneSvg.setAttribute('id', `preview-svg-${number}`);
            cloneSvg.setAttribute('width', '100');
            cloneSvg.setAttribute('height', '100');
            cloneSvg.setAttribute('viewBox', '0 0 200 200');
            cloneSvg.querySelector('.myCircle').setAttribute('fill', heart.circle);
            cloneSvg.querySelector('.myRect').setAttribute('fill', heart.rect);
            heartDiv.innerHTML = `<div class="preview-number">${number}:</div>`;
            heartDiv.appendChild(cloneSvg);
            heartList.appendChild(heartDiv);
          });
        }

        function pickColor(element) {
          selectedElement = element;
          colorPicker.value = element.getAttribute('fill');
          colorPicker.click();
        }

        colorPicker.addEventListener('input', function () {
          if (selectedElement) {
            selectedElement.setAttribute('fill', colorPicker.value);
          }
        });

        circle.addEventListener('click', function () {
          pickColor(circle);
        });

        rect.addEventListener('click', function () {
          pickColor(rect);
        });

        saveButton.addEventListener('click', function () {
          const currentColors = {
            circle: circle.getAttribute('fill'),
            rect: rect.getAttribute('fill'),
          };
          const savedHearts = JSON.parse(localStorage.getItem('hearts')) || [];
          if (!savedHearts.some((heart) => JSON.stringify(heart) === JSON.stringify(currentColors))) {
            savedHearts.push(currentColors);
            localStorage.setItem('hearts', JSON.stringify(savedHearts));
            loadHearts();
            errorMessage.style.display = 'none';
          } else {
            errorMessage.style.display = 'block';
          }
        });

        loadHearts();
      });
    </script>
  </body>
</html>
